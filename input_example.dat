MOLINFO STRUCTURE=./alad.pdb
WHOLEMOLECULES STRIDE=1 ENTITY0=1-22

phi: TORSION ATOMS=@phi-2
psi: TORSION ATOMS=@psi-2

bff: BF_FOURIER MINIMUM=-pi MAXIMUM=+pi ORDER=8
tdu: TD_UNIFORM

VES_LINEAR_EXPANSION ...
 LABEL=ves
 ARG=phi,psi
 BASIS_FUNCTIONS=bff,bff
 TEMP=300
 GRID_BINS=180,180
 TARGET_DISTRIBUTION=tdu
 BIAS_FILE=bias
 FES_FILE=fes
... VES_LINEAR_EXPANSION

OPT_TALOS ...
 BIAS=ves
 ARG=phi,psi
 GRID_MIN=-pi,-pi
 GRID_MAX=pi,pi
 GRID_BINS=60,60
 UPDATE_STEPS=1000
 EPOCH_NUM=4
 HIDDEN_NUMBER=3
 HIDDEN_LAYER=16
 HIDDEN_ACTIVE=RELU
 CLIP_RANGE=-0.01,0.01
 LABEL=opt
 COEFFS_FILE=coeffs.data
 FES_OUTPUT=100
 BIAS_OUTPUT=100
 COEFFS_OUTPUT=100
... OPT_TALOS

PRINT ...
  ARG=phi,psi
  FILE=colvar.info.data
  STRIDE=100
... PRINT

PRINT ...
  ARG=ves.*,opt.*
  FILE=colvar.bias.data
  STRIDE=100
... PRINT

